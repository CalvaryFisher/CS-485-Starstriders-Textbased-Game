<!DOCTYPE html>
<html>
<head>
<script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
</head>
<body style="">
<canvas style="border:1px solid #000000;">
</canvas>

<script>
const canvas = document.querySelector("canvas");

function resize(){
  canvas.width = window.innerWidth -20;
  canvas.height = window.innerHeight -20;
}

resize()
window.addEventListener('resize', resize)

var current_state;
var game_data;

$.getJSON( "data/map.json", function( data ) {
        game_data = data;
        current_state = data['start_state'];
        load_imgs();

});


function all_loaded(){
    draw(game_data['states']['0,0']['bk_img_loaded']); 
    console.log(current_state);
}

function load_imgs(){
    for (var key in game_data['states']){
        if(game_data['states'][key]['bk_img'] != null){
            console.log( key, game_data['states'][key]['bk_img'] );
            game_data['states'][key]['bk_img_loaded'] = new Image();
            game_data['states'][key]['bk_img_loaded'].src = game_data['states'][key]['bk_img']; 
        }
    }
    all_loaded();
}

const up_arrow = 38;
const down_arrow = 40;
const left_arrow = 37;
const right_arrow = 39;

var cur_pos_x = 0;
var cur_pos_y = 0;


document.body.onkeydown = function(e){
    if(e.keyCode == up_arrow){
        cur_pos_x = cur_pos_x +1;
    }
    
    alert(String.fromCharCode(e.keyCode)+" --> "+e.keyCode);
};

function draw(img) {
  var ctx = canvas.getContext('2d');
  ctx.drawImage(img, -100, -100,  canvas.width-20,  canvas.height-20  );
}


</script>

</body>
</html>

